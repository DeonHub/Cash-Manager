<!DOCTYPE html>
<html>
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width">


      <title>Account - Cash Manager</title>

        {% load static %}
        
        <link rel="icon" href="{% static 'login/media/favicon.png' %}" type="image/jpg" />
        <link rel="icon" href="{% static 'login/media/icon-48x48.png' %}" type="image/jpg" />
        <link rel="icon" href="{% static 'login/media/icon-72x72.png' %}" type="image/jpg" />
        <link rel="icon" href="{% static 'login/media/icon-96x96.png' %}" type="image/jpg" />
        <link rel="icon" href="{% static 'login/media/icon-144x144.png' %}" type="image/jpg" />
        <link rel="icon" href="{% static 'login/media/icon-192x192.png' %}" type="image/jpg" />
    
        <meta name="apple-mobile-web-app-status-bar" content="#f7941d">
        <meta name="theme-color" content="#f7941d">

        <link rel="manifest" href="{% static 'login/js/manifest.webmanifest' %}" />
        {% comment %} <link rel="manifest" href="{% static 'login/js/manifest.webmanifest' %}" /> {% endcomment %}
        
        
        {% comment %} <script src="http://127.0.0.1:8000/service-worker.js"></script> {% endcomment %}

        <script src="{% static 'superuser/js/script.js' %}"></script>
        <script src="{% static 'superuser/js/side.js' %}"></script>
        <link rel="icon" href="{% static 'superuser/media/favicon.jpg' %}" type="image/jpg" />

        <link rel="stylesheet" href="{% static 'superuser/css/style.css' %}" media="all">
        <link rel="stylesheet" href="{% static 'superuser/css/styles.css' %}" media="all">
        <link rel="stylesheet" href="{% static 'superuser/css/side.css' %}" media="all">
        
        <link href="https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/css/tom-select.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/js/tom-select.complete.min.js"></script>

        <link rel="stylesheet" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css " />

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.8.0/dist/chart.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"> 
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>


        <style>
          {% block style %}
          
          {% endblock %}
        </style>
        
    </head>
   
    <body>


      <div class="d-flex" id="wrapper">
        
        {% comment %} <!-- Sidebar--> {% endcomment %}
        <div class="border-end" id="sidebar-wrapper">
            <div class="sidebar-heading border-bottom text-center"><a href="{% url 'superuser:index'  %}">
              <img src="{% static 'superuser/media/aks.jpg' %}" alt="logo" />
            </a>
          </div>
            <div class="text-center mt-3 mb-3">
              {% comment %} {{pid}} {% endcomment %}
              {{ date }}<br/>
              {{ time }}
            </div>
            <hr/>
            <div class="list-group list-group-flush ">
                <a class="list-group-item list-group-item-action" href="{% url 'superuser:index' %}"><span class="material-symbols-outlined">speed</span><p>Dashboard</p></a>
                <div class="dropdown" style="width:100%;">
                  <a class="list-group-item list-group-item-action dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" href="#"><span class="material-symbols-outlined">settings</span><p>Account Settings</p></a>

                  <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1" style="background-color:black;">
                    <li><a class="list-group-item list-group-item-action" href="{% url 'superuser:viewFeeType' %}"><span class="material-symbols-outlined">view_kanban</span><p>Fee Types</p></a></li>
                    <li><a class="list-group-item list-group-item-action" href="{% url 'superuser:viewFeeItems' %}"><span class="material-symbols-outlined">list_alt</span><p>Fee Items</p></a></li>
                    <li><a class="list-group-item list-group-item-action" href="{% url 'superuser:viewFeeDescription' %}"><span class="material-symbols-outlined">description</span><p>Fee Descriptions</p></a></li>
                    <li><a class="list-group-item list-group-item-action" href="{% url 'superuser:viewCurrency' %}"><span class="material-symbols-outlined">payments</span><p>Currencies</p></a></li>
                    <li><a class="list-group-item list-group-item-action" href="{% url 'superuser:viewInvoiceDetails' %}"><span class="material-symbols-outlined">manage_accounts</span><p>Organization Details</p></a></li>
                    
                  </ul>
                </div>

                <a class="list-group-item list-group-item-action" href="{% url 'superuser:viewInvoice' %}"><span class="material-symbols-outlined">receipt</span><p>Assign Invoices</p></a>
                <a class="list-group-item list-group-item-action" href="{% url 'superuser:viewPaymentDuration' %}"><span class="material-symbols-outlined">view_timeline</span><p>Assigned Fees/Pay</p></a>
                <a class="list-group-item list-group-item-action" href="{% url 'superuser:viewPayments' %}"><span class="material-symbols-outlined">receipt_long</span><p>Payment Records</p></a>
               {% comment %} <a class="list-group-item list-group-item-action" href="{% url 'superuser:send_sms' %}"><span class="material-symbols-outlined">send</span><p>Send Message</p></a>{% endcomment %}
               {% comment %} <a class="list-group-item list-group-item-action" href="#"><span class="material-symbols-outlined">card_membership</span><p>Certification</p></a>{% endcomment %}
                <a class="list-group-item list-group-item-action" href="{% url 'superuser:viewMembers' %}"><span class="material-symbols-outlined">group</span><p>Members</p></a>
                <a class="list-group-item list-group-item-action" href="{% url 'superuser:viewAccessCodes' %}"><span class="material-symbols-outlined">code</span><p>Payment Codes</p></a>
               {% comment %} <a class="list-group-item list-group-item-action" href="{% url 'superuser:viewSubscribers' %}"><span class="material-symbols-outlined">group</span><p>Subscribers</p></a>{% endcomment %}
               {% comment %} <a class="list-group-item list-group-item-action" href="{% url 'superuser:viewDonations' %}"><span class="material-symbols-outlined">loyalty</span><p>Member Donations</p></a>{% endcomment %}
               {% comment %} <a class="list-group-item list-group-item-action" href="{% url 'superuser:viewPublicDonations' %}"><span class="material-symbols-outlined">volunteer_activism</span><p>Public Donations</p></a>{% endcomment %}
                <a class="list-group-item list-group-item-action" href="https://www.youtube.com/playlist?list=PL94Wg7vEQie4EojeY5BGDkR2I0Zyy9Ufa" target="_blank"><span class="material-symbols-outlined">smart_display</span><p>Video Tutorials</p></a>
                <a class="list-group-item list-group-item-action" href="{% url 'superuser:viewActivityLog' %}"><span class="material-symbols-outlined">edit</span><p>Activity Log</p></a>
            </div>
        </div>


        {% comment %} <!-- Page content wrapper--> {% endcomment %}
        <div id="page-content-wrapper">
            {% comment %} <!-- Top navigation--> {% endcomment %}
            <nav class="navbar navbar-expand-lg navbar-light bg-dark border-bottom">
                <div class="container-fluid">
                    <button class="btn btn-sm" id="sidebarToggle" style="background-color: #f7941d"><span class="material-symbols-outlined">menu</span></button>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>

                    <div class="d-flex flex-column ml-3 mt-3 mb-2 text-light demo" id="demo" style="text-align: center;width:100%;">
                         <h4>{{ account_name }}</h4>
                         <h6>Branch: {{ branch }}</h6>
                         

                         
                          
                    </div>
                    
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav ms-auto mt-2 mt-lg-0">
                          
                            <li class="nav-item dropdown">

                              <div class="dropdown" >
                                <button class="btn btn-light btn-sm dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false" >
                                  <span class="material-symbols-outlined">account_circle</span>
                                </button>
                                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                  <li><a class="dropdown-item" href="{% url 'superuser:viewProfile' %}">Profile</a></li>
                                  <div class="dropdown-divider"></div> 
  
                                  <li><a class="dropdown-item" href="{% url 'superuser:logout' id=session_id %}" onclick="deleteCookie()">Log Out</a></li>
                                </ul>
                              </div>


                                {% comment %} <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="material-symbols-outlined">account_circle</span></a>
                                <div class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                                    <a class="dropdown-item" href="{% url 'superuser:viewProfile' %}">Profile</a>
                                    <div class="dropdown-divider"></div> 

                                    <a class="dropdown-item" href="{% url 'superuser:logout' %}" onclick="memberOut()">Log Out</a>
                                   
                                </div> {% endcomment %}
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>


            {% comment %} <!-- Page content--> {% endcomment %}
            <div class="container-fluid">

                {% block content %}

                {% endblock %}
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
            </div>
 
        </div>


    </div>

 

    <footer style="background-color:black;">
      <!-- Grid container -->
      
      <!-- Copyright -->
      <div class="text-center p-3 footer">
        Powered by
        <a class="text-white" href="https://akwaabasolutions.com/" target="_blank">Akwaaba Solutions</a>
      </div>
      <!-- Copyright -->
    </footer>
{% comment %} {% endcomment %}
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>



  <script>
    {% if messages %}
    {% for msg in messages %}
      swal('{{ msg }}');

    {% endfor %}

  {% endif %}
  </script>

<script>

  $(document).ready(function(){
    if (!localStorage.getItem("session_id")){
      window.location.href = '/';
    }
  })

  

  function deleteCookie() {
    document.cookie = "session_id=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;";
    localStorage.removeItem('session_id');

  }

  
$(document).ready(function(){

  $('#pay').click(function(e){
  
  e.preventDefault()
  
  var amount_paid = $('#amount_paid').val();
  var base = $('#base').val();
  var client_id = $('#client_id').val();
  
  var url = $(this).attr('href');
  var csrf = $('input[name=csrfmiddlewaretoken]').val()

  
  if(confirm("\tAre you sure you want to proceed to payment? \nYou'll have a maximum of 5 minutes to make payment")){
  
  
  
  $.ajax({
  url: url,
  method: "POST",
  data: {
      amount_paid,
      base,
      client_id,
      csrfmiddlewaretoken: csrf
  }
  }).done(function(data){
  
      // alert("Done")
      alert("Done")
      window.location.href = data;
      // e.preventDefault()
  
  
    }).fail(function(data){
      alert("Something went wrong")
  
      console.log(data)
  
    })
   }
  })
})
  
  
  
  





  $(document).ready(function(){

    $(".js-data-example-ajax ").selectize(options);
  
  }) 






  $(document).ready(function () {
  
    $('#fee_typex').DataTable({
      pagingType: 'full_numbers',
      pageLength: 50,
    });
  
  });


  $(document).ready(function () {
  
    $('#fee_itemx').DataTable({
      pagingType: 'full_numbers',
      pageLength: 50,
    });
  
  });


  $(document).ready(function () {
  
    $('#fee_descriptionx').DataTable({
      pagingType: 'full_numbers',
      pageLength: 50,
    });
  
  });



  $(document).ready(function () {
  
    $('#currencyx').DataTable({
      pagingType: 'full_numbers',
      pageLength: 50,
    });
  
  });



  $(document).ready(function () {
  
    $('#invoice_detailx').DataTable({
      pagingType: 'full_numbers',
      pageLength: 50,
    });
  
  });





















  $(document).ready(function () {
  
    $('#members_table').DataTable({
      pagingType: 'full_numbers',
      pageLength: 50,
    });
  
  });
  
  $(document).ready(function () {
  
    $('#assigned_payments').DataTable({
      pagingType: 'full_numbers',
      pageLength: 50,
    });
  
  });
  
  $(document).ready(function () {
  
    $('#invoices').DataTable({
      pagingType: 'full_numbers',
      pageLength: 50,
    });
  
  });
  





  $(document).ready(function () {


    

    $('#all_payments').DataTable({
      pagingType: 'full_numbers',
      pageLength: 50,
    });
    
  
  });
  

  $(document).ready(function () {
  
    $('#activites_log').DataTable({
      pagingType: 'full_numbers',
      pageLength: 50,
    });
  
  });
  
  

  $(document).ready(function () {
  
    $('#codes_log').DataTable({
      pagingType: 'full_numbers',
      pageLength: 100,
    });
  
  });
  
  
  {% comment %} 
  $(document).ready(function () {
    
    $('#archived_table').DataTable({
      pagingType: 'full_numbers',
    });
  
  });
  
  $(document).ready(function () {
    
    $('#payment_history').DataTable({
      pagingType: 'full_numbers',
    });
  
  });
  
  $(document).ready(function () {
    
    $('#module_fees').DataTable({
      pagingType: 'full_numbers',
    });
  
  });
  
  $(document).ready(function () {
    
    $('#active_fees').DataTable({
      pagingType: 'full_numbers',
    });
  
  });
  
  $(document).ready(function () {
    
    $('#special_history').DataTable({
      pagingType: 'full_numbers',
    });
  
  });
  
  $(document).ready(function () {
    
    $('#payment_details').DataTable({
      pagingType: 'full_numbers',
    });
  
  });
  
  $(document).ready(function () {
    
    $('#sizes').DataTable({
      pagingType: 'full_numbers',
    });
  
  });
   {% endcomment %}
  


  $(document).ready(function(){
    $('.reset-code').on('click', function(e) {
     e.preventDefault()
     
     var $this = $(this)
     var member_id = $this.attr("data-id")
     var id = $this.attr("id")

     // alert(member_id)
 
 
     if(confirm("Are you sure you want to reset this code?")){
       $.ajax({
         url: $this.attr("href"),
         data: {
          'member_id': member_id,
         },
         success: function(resp){
             alert("Payment code reset successfully")
         },
       });

      
     }
     return false;
    }) 
 })





   




  $(document).ready(function(){
    $('#delete_button').click(function(){
      var id = [];
      var url = $("#delete_button").attr("data-delete-url");
      var csrf = $('input[name=csrfmiddlewaretoken]').val()

      $(':checkbox:checked').each(function(i){
        id[i]=$(this).val()
      })

      if(id.length == 0){
        alert("Please select item to delete")
      }
      else{
        if(confirm("Are you sure you want to delete this item?")){

          $.ajax({
            url: url,
            method: "POST",
            data: {
              id,
              csrfmiddlewaretoken: csrf
            },
            success: function(response){
              for(var i=0; i<id.length; i++){
                $('tr#'+id[i]+'').css('background-color', '#ccc');
                $('tr#'+id[i]+'').fadeOut('slow');
              }
            } 
          })   
    }

  }
  })
})


$(document).ready(function(){
   $('.link-delete').on('click', function(e) {
    e.preventDefault()
    
    var $this = $(this)
    var id = $this.attr("id")
    var csrf = $('input[name=csrfmiddlewaretoken]').val()


    if(confirm("Are you sure you want to delete this item?")){
      $.ajax({
        url: $this.attr("href"),
        method: "POST",
        data: {
          id,
          csrfmiddlewaretoken: csrf
        },
        success: function(resp){
          for(var i=0; i<100; i++){
            $('tr#'+id+'').css('background-color', '#ccc');
            $('tr#'+id+'').fadeOut('slow');
          }          
        },
      });
    }
    return false;
   }) 
})



$(document).ready(function(){
  $('.unassign').on('click', function(e) {
   e.preventDefault()
   
   var $this = $(this)
   var id = $this.attr("id")
   var csrf = $('input[name=csrfmiddlewaretoken]').val()


   if(confirm("Are you sure you want unassign member?")){
     $.ajax({
       url: $this.attr("href"),
       method: "POST",
       data: {
         id,
         csrfmiddlewaretoken: csrf
       },
       success: function(resp){
         for(var i=0; i<100; i++){
           $('tr#'+id+'').css('background-color', '#ccc');
           $('tr#'+id+'').fadeOut('slow');
         }          
       },
     });
   }
   return false;
  }) 
})




$(document).ready(function(){
  $('.des-delete').on('click', function(e) {
   e.preventDefault()
   
   var $this = $(this)
   var id = $this.attr("id")
   var csrf = $('input[name=csrfmiddlewaretoken]').val()

   if(confirm("Are you sure you want to delete this item?")){
     $.ajax({
       url: $this.attr("href"),
       method: "POST",
       data: {
         id,
         csrfmiddlewaretoken: csrf
       },
       success: function(resp){
         for(var i=0; i<100; i++){
           $('tr#'+id+'').css('background-color', '#ccc');
           $('tr#'+id+'').fadeOut('slow');
         }          
       },
     });
   }
   return false;
  }) 
})


$(document).ready(function(){
  $('.cur-delete').on('click', function(e) {
   e.preventDefault()
   
   var $this = $(this)
   var id = $this.attr("id")
   var csrf = $('input[name=csrfmiddlewaretoken]').val()

   if(confirm("Are you sure you want to delete this item?")){
     $.ajax({
       url: $this.attr("href"),
       method: "POST",
       data: {
         id,
         csrfmiddlewaretoken: csrf
       },
       success: function(resp){
         for(var i=0; i<100; i++){
           $('tr#'+id+'').css('background-color', '#ccc');
           $('tr#'+id+'').fadeOut('slow');
         }          
       },
     });
   }
   return false;
  }) 
})



$(document).ready(function(){
  $('.item-delete').on('click', function(e) {
   e.preventDefault()
   
   var $this = $(this)
   var id = $this.attr("id")
   var csrf = $('input[name=csrfmiddlewaretoken]').val()

   if(confirm("Are you sure you want to delete this item?")){
     $.ajax({
       url: $this.attr("href"),
       method: "POST",
       data: {
         id,
         csrfmiddlewaretoken: csrf
       },
       success: function(resp){
         for(var i=0; i<100; i++){
           $('tr#'+id+'').css('background-color', '#ccc');
           $('tr#'+id+'').fadeOut('slow');
         }          
       },
     });
   }
   return false;
  }) 
})



$(document).ready(function(){
  $('.detail-delete').on('click', function(e) {
  e.preventDefault()
  
  var $this = $(this)
  var id = $this.attr("id")
  var csrf = $('input[name=csrfmiddlewaretoken]').val()

  if(confirm("Are you sure you want to delete this item?")){
    $.ajax({
      url: $this.attr("href"),
      method: "POST",
      data: {
        id,
        csrfmiddlewaretoken: csrf
      },
      success: function(resp){
        for(var i=0; i<100; i++){
          $('tr#'+id+'').css('background-color', '#ccc');
          $('tr#'+id+'').fadeOut('slow');
        }          
      },
    });
  }
  return false;
  }) 
})














  $(document).ready(function(){
    $('#delete_assigned').click(function(){
      var id = [];
      var url = $("#delete_assigned").attr("data-remove-url");
      var csrf = $('input[name=csrfmiddlewaretoken]').val()
      $(':checkbox:checked').each(function(i){
        id[i]=$(this).val()
      })

      if(id.length == 0){
        alert("Please select item to delete")
      }
      else{
        if(confirm("Are you sure you want to delete this item?")){

          $.ajax({
            url: url,
            method: "POST",
            data: {
              id,
              csrfmiddlewaretoken: csrf
            },
            success: function(response){
              for(var i=0; i<id.length; i++){
                $('tr#'+id[i]+'').css('background-color', '#ccc');
                $('tr#'+id[i]+'').fadeOut('slow');
              }
            } 
          })   
    }
  }
  })
})


$(document).ready(function(){
  $('#delete_invoice').click(function(){
    var id = [];
    var url = $("#delete_invoice").attr("data-pop-url");
    var csrf = $('input[name=csrfmiddlewaretoken]').val()
    $(':checkbox:checked').each(function(i){
      id[i]=$(this).val()
    })

    if(id.length == 0){
      alert("Please select item to delete")
    }
    else{
      if(confirm("Are you sure you want to delete this item?")){

        $.ajax({
          url: url,
          method: "POST",
          data: {
            id,
            csrfmiddlewaretoken: csrf
          },
          success: function(response){
            for(var i=0; i<id.length; i++){
              $('tr#'+id[i]+'').css('background-color', '#ccc');
              $('tr#'+id[i]+'').fadeOut('slow');
            }
          } 
        })   
  }
}
})
})




$(document).ready(function(){
  $("#fee_type_id").change(function () {
    var url = $("#myFormID").attr("data-items-url");
    var fee_type = $(this).val();
    var subgroup = $("#all_subgroups").val();
  
      
    $("#subgroup_id").val(subgroup);

    $.ajax({
      url: url,
      data: {
        'fee_type': fee_type,
      },
      success: function (data) {
        $("#fee_items").html(data);
      }
    });

  });
})



$(document).ready(function(){
  $("#branch").change(function () {
    var url = $(this).attr("data-groups-url");
    var pid = $(this).attr("data-pid");
    var branch = $(this).val();


    $.ajax({
      url: url,
      data: {
        'branch': branch,
        'pid':pid,
      },
      success: function (data) {
         // alert(data)
         $("#all_groups").html(data);
         $("#branch_id").val(branch);
      }
    });

});

})



$(document).ready(function(){
  $("#all_groups").change(function () {
    var url = $(this).attr("data-subgroups-url");
    var group = $(this).val();
    var pid = $(this).attr("data-pid");


    $.ajax({
      url: url,
      data: {
        'group': group,
        'pid':pid,
      },
      success: function (data) {
         // alert(data)
         $("#all_subgroups").html(data);
         $("#group_id").val(group);
      }
    });

});

})



$(document).ready(function(){
  $("#all_subgroups").change(function () {
    var subgroup = $(this).val();

    $("#subgroup_id").val(subgroup);

});

})



$(document).ready(function(){
  $("#user_member").change(function () {
    var url = $("#makePaymentForm").attr("data-fee-url");
    var member = $(this).val();

    $.ajax({
      url: url,
      data: {
        'member': member,
      },
      success: function (data) {
        $("#fee_type").html(data);
      }
    });

  });
})


$(document).ready(function(){
  $("#fee_type").change(function () {
    var url = $("#makePaymentForm").attr("data-balance-url");
    var member = $("#user_member").val();
    var fee_type = $(this).val();

    $.ajax({
      url: url,
      data: {
        'fee_type': fee_type,
        'member': member,
      },
      success: function (data) {
        $("#user_type").html(data);
      }
    });

  });
})



$(document).ready(function(){
  $("#fee_type").change(function () {
    var url = $("#assignPaymentForm").attr("data-invoice-url");
    var branch = $("#branch").val();
    var member_category = $("#member_category").val();
    var group = $("#group").val();
    var subgroup = $("#subgroup").val();

    var fee_type = $(this).val();

    $.ajax({
      url: url,
      data: {
        'branch': branch,
        'member_category': member_category,
        'group': group,
        'subgroup': subgroup,
        'fee_type': fee_type,
      },
      success: function (data) {
         // alert(data)
         $("#total").val(data);
      }
    });

});

})





$(document).ready(function(){
  $("#numver").change(function () {
    var url = $("#paymentForm").attr("data-amount-url");
    var id = $("#paymentForm").attr("data-id");
    var range = $('input[name="install_range"]:checked').val();
  
    var period = $(this).val();


    
    $.ajax({
      url: url,
      data: {
        'id': id,
        'range': range,
        'period': period,
      },
      success: function (data) {
         // alert(data)
         $("#total_amount_due").val(data);
         // $("#paid").val(data);

         $("#paid").val(parseInt($("#total_amount_due").val()) - parseInt($("#balance").val()))
         $("#amount_paid").val($("#paid").val())

         var number = $("#amount_paid").val() * parseFloat($("#charge_percentage").val() * 0.01)
         //let round_number = number.toFixed(2);

         $("#charge").val(number.toFixed(2))

         if(parseInt($("#amount_paid").val()) >= parseInt($("#paid").val())){
                                
        
          if(parseInt($("#expiration_bill").val()) > 0){
            $("#arrears").val(parseInt($("#expiration_bill").val()) - parseInt($("#amount_paid").val()))
            
               if($("#arrears").val() < 0){
                  $("#arrears").val(0)     
                }
          }
           else{
            $("#arrears").val(parseInt($("#outstanding_bill").val()) - parseInt($("#amount_paid").val()))
               //arrears.value = parseInt(outstanding_bill.value) - parseInt(amount.value)
               if($("#arrears").val() < 0){
                $("#arrears").val(0)     
            }
           }
        }

      }
    });

    
});

})




/*
$(document).ready(function(){
  $("#payment_status").change(function () {
    var url = $("#paymentForm").attr("data-credit-url");
    var member = $("#user").val();
    var member_id = $("#member_id").val();
    
    var paid = $("#paid")
    var total_amount_due = $("#total_amount_due")


    $.ajax({
      url: url,
      data: {
        'member': member,
        'member_id':member_id
      },

      success: function (data) {
         // alert(data)
         $("#balance").val(0);

          $("#paid").val(parseInt($("#total_amount_due").val()) - parseInt(data))
         
          if(parseInt($("#paid").val()) < 0){
            $("#paid").val(0)
            }
        
 
          
      }
    });

});

})




$(document).ready(function(){
  $("#numver").change(function () {
    var url = $("#paymentForm").attr("data-credit-url");
    var member = $("#member").val();
    var paid = $("#paid")
    var total_amount_due = $("#total_amount_due")

    $.ajax({
      url: url,
      data: {
        'member': member,

      },
      success: function (data) {
         // alert(data)
         $("#balance").val(data);

         $("#paid").val(parseInt($("#total_amount_due").val()) - parseInt(data))
         if(parseInt($("#paid").val()) < 0){
          $("#paid").val(0)
          }
      }
    });

});

})


*/


$(document).ready(function(){
  $("#page").change(function () {
    var url = $("#pageForm").attr("data-page-url");
    var page_number = $(this).val();

    $.ajax({
      url: url,
      data: {
        'page_number': page_number,
      },
      success: function (data) {
        
      }
    });

});

})










$(document).ready(function(){

$("#per_page").change(function(){
  var value=$(this).val();

  window.location.href="?page=1&per_page="+value

})
})


$(document).ready(function(){

  $(".pagination li").click(function(){
    var pagenumber=this.id
    var perpage=$("#per_page").val()

  
    window.location.href="?page="+pagenumber+"&per_page="+perpage
  
  })
  })





$(document).ready(function(){

  $("#filter").click(function(){
    var year_range=$('#year_range').val();
    var branches=$('#branches').val();
    var member_category=$('#member_category').val();
    // var member_category='Nonstaff'
    var group=$('#group').val();
    var subgroup=$('#subgroup').val();
    var start_date=$('#start_date').val();
    var end_date=$('#end_date').val();

    var yr = document.getElementById('year_range').value

    yr == "" ? year = new Date().getFullYear() : year = yr

    if(start_date == ''){
      start_date = new Date(year, 0, 1).toISOString().split("T")[0] 
    }

     
    window.location.href=`?year_range=${year_range}&branches=${branches}&member_category=${member_category}&group=${group}&subgroup=${subgroup}&start_date=${start_date}&end_date=${end_date}`
  
  })
  })





    
$(document).ready(function(){
  var yr = document.getElementById('year_range').value

  yr == "" ? year = new Date().getFullYear() : year = yr
  
  if(yr == new Date().getFullYear()){
    document.getElementById('start_date').max = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000).toISOString().split("T")[0];
    document.getElementById('end_date').max = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000).toISOString().split("T")[0]

  }else{
    document.getElementById('start_date').max = new Date(year, 12, 0).toISOString().split("T")[0]  
    document.getElementById('end_date').max = new Date(year, 12, 0).toISOString().split("T")[0]
  }


  document.getElementById('end_date').min = new Date(year, 0, 1).toISOString().split("T")[0];
  document.getElementById('start_date').min = new Date(year, 0, 1).toISOString().split("T")[0];

})


$(document).ready(function(){})

















$(document).ready(function(){

  // Open Popup
  $('[popup-open]').on('click', function() {
      var popup_name = $(this).attr('popup-open');
      var assigned_id = $(this).attr('data-id');
      var url = $(this).attr('data-url');

      $.ajax({
        url: url,
        data: {
          'assigned_id': assigned_id,
        },
        success: function (data) {
          $("#desc").html(data);
        }
      });
      
      
$('[popup-name="' + popup_name + '"]').fadeIn(300);
  });

  // Close Popup
  $('[popup-close]').on('click', function() {
var popup_name = $(this).attr('popup-close');
$('[popup-name="' + popup_name + '"]').fadeOut(300);
  });

  // Close Popup When Click Outside
  $('.popup').on('click', function() {
var popup_name = $(this).find('[popup-close]').attr('popup-close');
$('[popup-name="' + popup_name + '"]').fadeOut(300);
  }).children().click(function() {
return false;
  });

})


</script>

<script>
  var settings = {};
  new TomSelect('#member',settings);
</script>


    </body>
 
</html>


